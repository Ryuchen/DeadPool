<h1 align="center">Welcome to DeadPool</h1>
<p align="center">
  <img src="https://img.shields.io/badge/version-beta-red.svg?cacheSeconds=2592000"  alt="version"/>
  <img src="https://img.shields.io/badge/language-python3-blue.svg?cacheSeconds=2592000"  alt="language"/>
  <img src="https://img.shields.io/badge/platform-linux-blue.svg?cacheSeconds=2592000"  alt="platform"/>
  <a href="http://www.gnu.org/licenses/gpl-3.0.html">
    <img alt="License: GPL" src="https://img.shields.io/badge/License-GPL-yellow.svg"/>
  </a>
</p>

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªä½¿ç”¨celeryä½œä¸ºä¸»ä½“æ¡†æ¶çš„çˆ¬è™«åº”ç”¨(å¸Œæœ›åæœŸèƒ½å¤Ÿå†™æˆå¤§å‹çš„çˆ¬è™«é¡¹ç›®æ¡†æ¶)ï¼Œçµæ„Ÿæºè‡ªç›®å‰åœ¨å­¦æ ¡è¿›è¡Œçš„çŸ¥è¯†å›¾è°±çš„ç§‘ç ”é¡¹ç›®ï¼Œä¸»è¦ç”¨äºè¯¥é¡¹ç›®çš„ç½‘ä¸Šæ–‡æœ¬æ•°æ®é‡‡é›†å·¥ä½œã€‚

### ğŸ  [ä¸ªäººå°æ ˆ](https://ryuchen.github.io/)

  > å¦‚æœä½ è§‰å¾—è¿™ä¸ªé¡¹ç›®ä¸é”™ï¼Œæƒ³è¦æ·±å…¥äº†è§£ï¼Œå¯ä»¥å…³æ³¨ä¸Šé¢çš„ä¸ªäººå°æ ˆï¼Œæœªæ¥æ›´æ–°çš„è¯´æ˜ä¼šåˆŠç™»åœ¨è¿™é‡Œï¼Œå¹¶ä¸”ä¼šä¸å®šæ—¶åˆ†äº«éƒ¨åˆ†å†…å®¹å’Œå¿ƒå¾—

### ğŸ“ é¡¹ç›®è¯´æ˜:

* å› ä¸ºä¹‹å‰å·¥ä½œæœŸé—´æ·±å…¥ä½¿ç”¨è¿‡ celery ä½œä¸º django web çš„åå°å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ï¼Œä½†æ˜¯æ·±æ„Ÿ celery çš„å¼ºå¤§ï¼Œå¹¶ä¸åº”è¯¥å±€é™åœ¨ django å¼‚æ­¥ä»»åŠ¡ä¸­é™„å¸¦ä½¿ç”¨ã€‚
* äºæ˜¯æƒ³æ·±å…¥æ‹“å±•ä¸€ä¸‹è¯¥æ¡†æ¶çš„ä½¿ç”¨ï¼Œä¾¿æƒ³ä»¥celeryä½œä¸ºä¸»æ¡†æ¶æ„å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯åç»­åœ¨ç½‘ä¸Šæ²¡æœ‰æœç´¢åˆ°å…³äº celery çš„å•ç‹¬é¡¹ç›®ä½œä¸ºå‚è€ƒ( å¯èƒ½æ˜¯æˆ‘æœçš„å§¿åŠ¿ä¸å¯¹ï¼Œæ¯•ç«Ÿèº«é«˜ä¸å¤Ÿï¼Œè§†çº¿å¤ªä½ =.= )ã€‚
* æ—¢ç„¶æ²¡èƒ½æ‰¾åˆ°ä¸€ä¸ªå¾ˆå¥½çš„ä»‹ç»å’Œä½¿ç”¨ celery çš„å¼€æº demo ï¼Œé‚£å°±è‡ªå·±æ¥å§ï¼Œæ¯•ç«Ÿèº«ä¸ºç¨‹åºå‘˜ï¼Œæœ€å¤§çš„æŠ€èƒ½å°±æ˜¯åŠ¨æ‰‹é€ é‡å¤çš„è½®å­ï¼Œå¹¶ä¸”æ²‰è¿·å…¶ä¸­ä¸å¯è‡ªæ‹”ã€‚
* ç›®å‰ç ”ç©¶ç”Ÿé˜¶æ®µåœ¨æå®éªŒå®¤ä¸­çš„çŸ¥è¯†å›¾è°±æ„å»ºçš„ç›¸å…³å·¥ç¨‹ï¼Œé‚£ä¹ˆçŸ¥è¯†çš„æ¥æºæ˜¯æœ€é‡è¦çš„ï¼Œç´¢æ€§å°±ä»¥æ­¤å‡ºå‘æ ¹æ®è¯¥é¡¹ç›®æ„å»ºä¸€ä¸ªèƒ½å¤Ÿçˆ¬å–ä¸åŒç«™ç‚¹çš„é«˜å¹¶å‘çˆ¬è™«æ¡†æ¶ã€‚

é‰´äºä¸Šè¿°åŸå› ï¼Œæˆ‘æ„å»ºäº†è¿™ä¸ªé¡¹ç›®ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©è‡ªå·±æ·±å…¥ç†è§£å’Œç†Ÿç»ƒä½¿ç”¨ celery çš„å¼ºå¤§åŠŸèƒ½ã€‚

### ğŸ”¥ è®¾è®¡è¯´æ˜:

#### ä»»åŠ¡æ¨¡å—

appsä¸­æ³¨å†Œçš„ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡ [jobs.yaml](http://example.com/ "Develop Asynch Jobs") é…ç½®æ–‡ä»¶çš„ include æœºåˆ¶ï¼ŒåŠ¨æ€æ”¯æŒä»»åŠ¡åŠ è½½å’Œå–æ¶ˆ

å…·ä½“å¯ä»¥å‚è€ƒå¦‚ä¸‹:

```yaml

# Base Tasks Router Settings
# Task name
jobs:
  #
  # Proxy Pool Settings
  task_proxy: !include jobs.d/periodic.d/task_proxy.yaml
  #
  # Cookie Pool Settings
  # task_cookie: !include jobs.d/periodic.d/task_cookie.yaml
  #
  # Tmall Crawler Settings
  # task_tmall: !include jobs.d/async.d/task_tmall.yaml
  #
  # Eastmoney Crawler Settings
  task_eastmoney: !include jobs.d/async.d/task_eastmoney.yaml

```

çˆ¬è™«ä»»åŠ¡

```
/
â”œâ”€â”€ apps/   # ä»»åŠ¡ç›®å½•
    â”œâ”€â”€ asynch/   # å¼‚æ­¥ä»»åŠ¡ç›®å½•ï¼ˆä¹Ÿæ˜¯è¯¥æ¡†æ¶è¿è¡Œå„ç§çˆ¬è™«è„šæœ¬çš„ä¸»ç›®å½•ï¼‰        
        â”œâ”€â”€ tasks/
            â”œâ”€â”€ task_tmall/    # example for Tmall å•†å“çˆ¬å–ç›®å½•ï¼ˆå…¶ä»–çˆ¬å–ä»»åŠ¡è·Ÿè¯¥ç›®å½•æ¡†æ¶ä¸€è‡´ï¼‰
                â”œâ”€â”€ sqlite.sql    # ä¸ºäº†ä¹‹åä¸­æ–­ç»­çˆ¬åšå‡†å¤‡
                â”œâ”€â”€ __init__.py    # è¯¥ä»»åŠ¡çš„ä¸»ç¨‹åºå…¥å£
                â”œâ”€â”€ __main__.py    # è¯¥ä»»åŠ¡çš„ä¸»ç¨‹åºå…¥å£
                â”œâ”€â”€ crawler.py    # å•ä¸€çˆ¬å–ç¨‹åº
                â”œâ”€â”€ middleware.py    # çˆ¬å–åçš„é¡µé¢å¤„ç†ç¨‹åº
                â””â”€â”€ pipline.py    # å¤„ç†åçš„ä¿¡æ¯å­˜å‚¨ç¨‹åº
            â””â”€â”€ __init__.py
        â”œâ”€â”€ __init__.py
        â””â”€â”€ base.py    # å¼‚æ­¥ä»»åŠ¡çš„åŸºç±»ï¼Œç»§æ‰¿äº†è¯¥åŸºç±»æ‰èƒ½è¢«æ¡†æ¶æ­£ç¡®å¯¼å…¥
```

> æ„å»ºåœ¨ apps.asynch.tasks ç›®å½•ä¸‹é¢ï¼Œæ‹¥æœ‰å®Œå¤‡çš„æŠ½è±¡å®ç°é€»è¾‘ï¼Œå¹¶ä¸”ä»¥é…ç½®æ–‡ä»¶çš„å½¢å¼è¿›è¡Œä»»åŠ¡åŠŸèƒ½çš„å£°æ˜ï¼Œå…·ä½“å†…å®¹è¯·å‚è§: *å¦‚ä½•æ„å»ºè¯¥é¡¹ç›®çš„[çˆ¬è™«ä»»åŠ¡](http://example.com/ "Develop Asynch Jobs").*

* è¯¥å¥—ä»£ç æ‹¥æœ‰ä¸¤ä¸ªæ ·ä¾‹ç¨‹åºï¼ˆtask_tmallï¼‰å’Œï¼ˆtask_eastmoneyï¼‰
* task_eastmoney: æ˜¯çˆ¬å–[ä¸œæ–¹è´¢å¯Œç½‘](http://eastmoney.com)çš„å…³äºæŒ‡å®šå…³é”®è¯çš„è´¢ç»å’ŒæœŸè´§æ–°é—»
* task_tmall: æ˜¯çˆ¬å–[å¤©çŒ«](https://tmalll.com)çš„å•†å®¶è¯¦æƒ…é¡µé¢ä¸­çš„ä¹°å®¶è¯„ä»·ä¿¡æ¯

* æ¯ä¸ªä»»åŠ¡åŒ…å«å››ä¸ªä¸»è¦éƒ¨åˆ†
  * __main__.py ä¸»çˆ¬è™«çš„å…¥å£ç¨‹åºï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æ„å»ºä»£ç æ‰§è¡Œé€»è¾‘
  * crawler.py å•ä¸ªä¸»ä½“çš„çˆ¬è™«ç¨‹åºåˆ©ç”¨ requests è¯·æ±‚é¡µé¢è¿›è¡Œé¢„å¤„ç†
  * middleware.py æ¥æ”¶ crawler.py çš„è¾“å‡ºç»“æœï¼Œè¿›è¡Œæ•°æ®æ¸…æ´—å’Œæå–
  * pipeline.py å°†æ¸…æ´—åçš„ç»“æœæŒ‰ç…§é…ç½®æ–‡ä»¶å­˜å‚¨åˆ°æŒ‡å®šåœ°æ–¹
* èƒ½å¤Ÿå®ç°çˆ¬å–è¿‡ç¨‹çš„æ–­ç‚¹ç»­çˆ¬åŠŸèƒ½ï¼ˆTODOï¼‰
  * sqlite.sql æ•°æ®è„šæœ¬æ–‡ä»¶åˆ›å»º sqlite3 å°æ•°æ®åº“ä½œä¸ºçˆ¬å–è®°å½•
  
é…ç½®æ–‡ä»¶(æ ·ä¾‹)

```yaml
# éœ€è¦è¿›è¡Œå¼•å…¥çš„ç±»çš„åç§°
class: "TaskEastmoney"
# ä»»åŠ¡æ‰€åœ¨çš„ç±»åˆ«
module: "asynch"
# é…ç½®
options:
  # ç™»å½•é…ç½®å£°æ˜ 
  login:
    enable: false
    nickname: 'nickname'
    username: 'username'
    password: 'password'
  # proxy é…ç½®å£°æ˜
  proxy: true
  # cookie é…ç½®å£°æ˜
  cookie: true
  # å¯ç”¨çš„å­˜å‚¨æ¨¡å—å£°æ˜
  storage:
    module: "MongoStorage"
    collection: ""
  # çˆ¬å–æ—¶çš„å…³é”®å­—
  keyword:
    - "å¤§è±†"
```

---

å‘¨æœŸä»»åŠ¡

```
/
â”œâ”€â”€ apps/   # ä»»åŠ¡ç›®å½•
    â”‚â”€â”€ periodic/   # å®šæ—¶ä»»åŠ¡ç›®å½•ï¼ˆè¯¥æ¡†æ¶çš„é€šç”¨è„šæœ¬ç›®å½•ï¼‰
        â”œâ”€â”€ tasks/  
            â”œâ”€â”€ task_cookie/   # å‘¨æœŸæ£€æŸ¥è¯·æ±‚çš„ cookie æ˜¯å¦å¯ç”¨ ï¼ˆTODOï¼‰
                â”œâ”€â”€ __init__.py
                â””â”€â”€ __main__.py
            â”œâ”€â”€ task_proxy/   # å‘¨æœŸæ€§æ›´æ–°ä»£ç†æ± ä¸­çš„IPåœ°å€
                â”œâ”€â”€ __init__.py
                â””â”€â”€ __main__.py
            â””â”€â”€ __init__.py
        â”œâ”€â”€ __init__.py
        â””â”€â”€ base.py    # å®šæ—¶ä»»åŠ¡çš„åŸºç±»ï¼Œç»§æ‰¿äº†è¯¥åŸºç±»æ‰èƒ½è¢«æ¡†æ¶æ­£ç¡®å¯¼å…¥
```

> æ„å»ºåœ¨ apps.periodic.tasks ç›®å½•ä¸‹é¢ï¼Œåˆ©ç”¨celeryçš„å‘¨æœŸç‰¹æ€§ï¼Œå®Œæˆå‘¨æœŸæ€§ä»»åŠ¡çš„æ‰§è¡Œï¼Œå…·ä½“å†…å®¹è¯·å‚è§: *å¦‚ä½•æ„å»ºè¯¥é¡¹ç›®çš„[å‘¨æœŸä»»åŠ¡](http://example.com/ "Develop Periodic Jobs").*

* è¯¥å¥—ä»£ç æ‹¥æœ‰ä¸¤ä¸ªæ ·ä¾‹ç¨‹åºï¼ˆtask_cookieï¼‰(TODO) å’Œï¼ˆtask_proxyï¼‰
* task_proxy: æ„å»ºä»£ç†æ± ï¼Œå‘¨æœŸæ€§æ£€æŸ¥ä»£ç†æ± ä¸­ä»»åŠ¡çš„çŠ¶æ€ï¼Œç»´æŠ¤æœ€ä½æ ‡å‡†çš„å¯ç”¨IP
* task_cookie: æ„å»ºcookieæ± ï¼Œå‘¨æœŸæ€§æ£€æŸ¥å½“å‰cookieæ˜¯å¦å¯ç”¨ï¼Œç»´æŠ¤æœ€ä½æ ‡å‡†çš„å¯ç”¨cookie

é…ç½®æ–‡ä»¶(æ ·ä¾‹)

```yaml
# éœ€è¦è¿›è¡Œå¼•å…¥çš„ç±»çš„åç§°
class: "TaskProxy"
# ä»»åŠ¡æ‰€åœ¨çš„ç±»åˆ«
module: "periodic"
# é…ç½®
options:
  # set 0 proxy address will not force expire
  # Or will force expire current proxy pool in current expire setting (s)
  expire: 600
  pool:
    maximum: 60
    minimum: 10
  concurrent: 5
  # the job schedule time (min)
  crontab: "*"
```

---

æ’ä»¶æ¨¡å—

```
/
â”œâ”€â”€ common/   # é€šç”¨åº“
    â”œâ”€â”€ plugins/   # é€šç”¨è§£ææ’ä»¶åº“
        â”œâ”€â”€ human/   # æ¨¡æ‹ŸçœŸäººæ“ä½œçš„åº“
            â”œâ”€â”€ slider.py   # æ¨¡æ‹ŸçœŸäººæµè§ˆé¡µé¢æ“ä½œ
            â”œâ”€â”€ verification.py   # åçˆ¬éªŒè¯ç¨‹åºæ“ä½œ
            â””â”€â”€ __init__.py
        â”œâ”€â”€ storage/   # çˆ¬å–ç»“æœå­˜å‚¨çš„åº“
            â”œâ”€â”€ filestorage.py   # æ–‡ä»¶å½¢å¼æœ¬åœ°å­˜å‚¨
            â”œâ”€â”€ mongostorage.py   # mongodbå­˜å‚¨
            â””â”€â”€ __init__.py
        â””â”€â”€ __init__.py
```

> æ„å»ºåœ¨ common.plugins é›†æˆäº†å¸¸è§çš„åçˆ¬æœºåˆ¶è¯†åˆ«ã€äººä¸ºæ“ä½œæ¨¡æ‹Ÿå’Œå­˜å‚¨ç³»ç»Ÿæ”¯æŒ

* åœ¨ human åº“ä¸‹å®ç°äº†:
  * æ¨¡æ‹Ÿäººä¸ºæµè§ˆé¡µé¢è¿›è¡Œæ»‘åŠ¨çš„æ“ä½œ(slider.py)
  * å¸¸è§„æ»‘å—è¯†åˆ«äººæœºè¯†åˆ«çš„ç¨‹åºæ“ä½œ(verification.py) (TODO)
* åœ¨ storage åº“ä¸‹å®ç°äº†ï¼š
  * çˆ¬å–å†…å®¹çš„æœ¬åœ°ç£ç›˜æ–‡æœ¬å½¢å¼å­˜å‚¨çš„åŠŸèƒ½æ”¯æŒ(filestorage.py)
  * çˆ¬å–å†…å®¹çš„mongodbæ–‡æœ¬å½¢å¼å­˜å‚¨çš„åŠŸèƒ½æ”¯æŒ(mongostorage.py)
  
---

å…¶ä»–æ¨¡å—

> ä¸ºäº†å°½å¯èƒ½çš„æ‹“å±•æ”¯æŒçš„å¹³å°å’Œé¡¹ç›®çš„çµæ´»æ€§ï¼Œè€ŒåŠ å…¥çš„åŠŸèƒ½

* æ ¹æ®è¿è¡Œå¹³å°è‡ªåŠ¨åŠ è½½ç›¸å¯¹åº”çš„chromediveræ–‡ä»¶
* é€šè¿‡é…ç½®æ–‡ä»¶çš„ include æœºåˆ¶ï¼ŒåŠ¨æ€æ”¯æŒä»»åŠ¡åŠ è½½å’Œå–æ¶ˆ
* é€šè¿‡ elasticsearch è®°å½•ä»»åŠ¡è¿è¡Œä¸­çš„å®Œæ•´è¿‡ç¨‹ï¼ˆTODOï¼‰

### ğŸ‘Œ ä»£ç è¯´æ˜ï¼š

```
/
â”œâ”€â”€ apps/   # ä»»åŠ¡ç›®å½•
    â”œâ”€â”€ asynch/   # å¼‚æ­¥ä»»åŠ¡ç›®å½•ï¼ˆä¹Ÿæ˜¯è¯¥æ¡†æ¶è¿è¡Œå„ç§çˆ¬è™«è„šæœ¬çš„ä¸»ç›®å½•ï¼‰        
        â”œâ”€â”€ tasks/
            â”œâ”€â”€ task_tmall/    # example for Tmall å•†å“çˆ¬å–ç›®å½•ï¼ˆå…¶ä»–çˆ¬å–ä»»åŠ¡è·Ÿè¯¥ç›®å½•æ¡†æ¶ä¸€è‡´ï¼‰
                â”œâ”€â”€ sqlite.sql    # ä¸ºäº†ä¹‹åä¸­æ–­ç»­çˆ¬åšå‡†å¤‡
                â”œâ”€â”€ __init__.py    # è¯¥ä»»åŠ¡çš„ä¸»ç¨‹åºå…¥å£
                â”œâ”€â”€ __main__.py    # è¯¥ä»»åŠ¡çš„ä¸»ç¨‹åºå…¥å£
                â”œâ”€â”€ crawler.py    # å•ä¸€çˆ¬å–ç¨‹åº
                â”œâ”€â”€ middleware.py    # çˆ¬å–åçš„é¡µé¢å¤„ç†ç¨‹åº
                â””â”€â”€ pipline.py    # å¤„ç†åçš„ä¿¡æ¯å­˜å‚¨ç¨‹åº
            â””â”€â”€ __init__.py
        â”œâ”€â”€ __init__.py
        â””â”€â”€ base.py    # å¼‚æ­¥ä»»åŠ¡çš„åŸºç±»ï¼Œç»§æ‰¿äº†è¯¥åŸºç±»æ‰èƒ½è¢«æ¡†æ¶æ­£ç¡®å¯¼å…¥
    â”‚â”€â”€ periodic/   # å®šæ—¶ä»»åŠ¡ç›®å½•ï¼ˆè¯¥æ¡†æ¶çš„é€šç”¨è„šæœ¬ç›®å½•ï¼‰
        â”œâ”€â”€ tasks/  
            â”œâ”€â”€ task_cookie/   # å‘¨æœŸæ£€æŸ¥è¯·æ±‚çš„ cookie æ˜¯å¦å¯ç”¨ ï¼ˆTODOï¼‰
                â”œâ”€â”€ __init__.py
                â””â”€â”€ __main__.py
            â”œâ”€â”€ task_proxy/   # å‘¨æœŸæ€§æ›´æ–°ä»£ç†æ± ä¸­çš„IPåœ°å€
                â”œâ”€â”€ __init__.py
                â””â”€â”€ __main__.py
            â””â”€â”€ __init__.py
        â”œâ”€â”€ __init__.py
        â””â”€â”€ base.py    # å®šæ—¶ä»»åŠ¡çš„åŸºç±»ï¼Œç»§æ‰¿äº†è¯¥åŸºç±»æ‰èƒ½è¢«æ¡†æ¶æ­£ç¡®å¯¼å…¥
â”œâ”€â”€ bin/
    â””â”€â”€ chromedriver.exe   # browser driver é©±åŠ¨ç¨‹åº
â”œâ”€â”€ common/   # é€šç”¨åº“
    â”œâ”€â”€ plugins/   # é€šç”¨è§£ææ’ä»¶åº“
        â”œâ”€â”€ human/   # æ¨¡æ‹ŸçœŸäººæ“ä½œçš„åº“
            â”œâ”€â”€ slider.py   # æ¨¡æ‹ŸçœŸäººæµè§ˆé¡µé¢æ“ä½œ
            â”œâ”€â”€ verification.py   # åçˆ¬éªŒè¯ç¨‹åºæ“ä½œ
            â””â”€â”€ __init__.py
        â”œâ”€â”€ storage/   # çˆ¬å–ç»“æœå­˜å‚¨çš„åº“
            â”œâ”€â”€ filestorage.py   # æ–‡ä»¶å½¢å¼æœ¬åœ°å­˜å‚¨
            â”œâ”€â”€ mongostorage.py   # mongodbå­˜å‚¨
            â””â”€â”€ __init__.py
        â””â”€â”€ __init__.py
    â”œâ”€â”€ settings.py   # é…ç½®
    â”œâ”€â”€ singleton.py   # å•ä¾‹æ¨¡å¼
    â”œâ”€â”€ sqlitedao.py   # sqlite3æ“ä½œå°è£…ï¼Œç”¨äºçˆ¬å–è¿‡ç¨‹ä¸­çš„è®°å½•
    â”œâ”€â”€ timetrans.py   # æ—¶é—´æ ¼å¼è½¬æ¢
    â”œâ”€â”€ exceptions.py   # å¼‚å¸¸ç±»å°è£…
    â””â”€â”€ __init__.py    
â”œâ”€â”€ config/   # é…ç½®ç›®å½•
    â””â”€â”€ jobs.d/   # ä»»åŠ¡é…ç½®ç›®å½•
        â”œâ”€â”€ async.d/
            â””â”€â”€ task_tmall.yaml
        â”œâ”€â”€ periodic.d/
            â”œâ”€â”€ task_cookie.yaml
            â””â”€â”€ task_proxy.yaml
        â”œâ”€â”€ config.yaml   # é€šç”¨é…ç½®
        â””â”€â”€ jobs.yaml   # ä»»åŠ¡åŠ è½½é…ç½®ï¼ˆå°† jobs.d ä¸­çš„é…ç½®æ–‡ä»¶ include è¿›æ¥åå¼€å¯ä»»åŠ¡ï¼‰
â”œâ”€â”€ contrib/   # celery æ ¸å¿ƒåº“
    â”œâ”€â”€ elastic/   # elasticsearchï¼ˆç”¨äºæ‰§è¡Œä»»åŠ¡æ—¥å¿—è®°å½•ï¼‰
        â”œâ”€â”€ indices/   # elasticsearch index mapping 
            â”œâ”€â”€ rlogs.py   # è¿è¡Œæ—¥å¿—çš„ index mapping
            â””â”€â”€ __init__.py
        â”œâ”€â”€ base.py   # elasticsearch å®ä¾‹åˆ›å»ºç±»
        â””â”€â”€ __init__.py
    â”œâ”€â”€ mysql/   # mysqlï¼ˆç”¨æ¥æš‚å­˜ IP proxyï¼‰
        â”œâ”€â”€ tables/    # mysql table mapping 
            â”œâ”€â”€ proxy.py   # IP proxy table mapping
            â””â”€â”€ __init__.py
        â”œâ”€â”€ base.py
        â””â”€â”€ __init__.py
    â”œâ”€â”€ redis/   # redisï¼ˆcelery è¿è¡Œæ—¶çš„brokerå’Œbackendï¼‰
        â”œâ”€â”€ base.py   # redis å®ä¾‹åˆ›å»ºç±»
        â””â”€â”€ __init__.py
    â””â”€â”€ __init__.py
â”œâ”€â”€ deadpool/   # celery application ä¸»ç›®å½•
    â”œâ”€â”€ celery.py   # ç¨‹åºä¸»å…¥å£
    â””â”€â”€ __init__.py
â”œâ”€â”€ driver/   # broswer é©±åŠ¨å­˜æ”¾ç›®å½•
    â”œâ”€â”€ chromedriver_linux64.zip
    â”œâ”€â”€ chromedriver_mac64.zip
    â””â”€â”€ chromedriver_win32.zip
â”œâ”€â”€ logs   # è¿è¡Œæ—¥å¿—
â”œâ”€â”€ result   # filestorage æ’ä»¶çš„é»˜è®¤ç»“æœå­˜æ”¾ç›®å½•ï¼ˆå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ï¼‰
â”œâ”€â”€ test   # å¼€å‘æ—¶å€™çš„æµ‹è¯•è„šæœ¬
â””â”€â”€ utils/   # å·¥å…·åº“
    â”œâ”€â”€ driver.py   # ä¾æ®å¹³å°åŠ è½½ browser é©±åŠ¨
    â”œâ”€â”€ loader.py   # yamlæ–‡ä»¶çš„ç¬¬ä¸‰æ–¹Loader
    â”œâ”€â”€ network.py   # ä¸»æœºç½‘ç»œä¿¡æ¯è„šæœ¬
    â””â”€â”€ __init__.py
```

### ğŸ“– ä½¿ç”¨è¯´æ˜:

#### ç¯å¢ƒæ­å»º

è¯¥é¡¹ç›®æœ€ç»ˆå°†é€‚é… å…¨å¹³å°è¿è¡Œï¼ˆmacOSï¼ŒWindowsï¼ŒLinuxï¼‰ï¼Œä½†æ˜¯ç›®å‰å°šå¤„äºbetaç‰ˆæœ¬çš„å¼€å‘ï¼Œä»¥ä¸‹è¯´æ˜å‡ä¸ºåœ¨ Windows ä¸‹çš„å¼€å‘è¯´æ˜

å¼€å‘ç¯å¢ƒ

* Windows 10 (Version 2004) WSL2 Ubuntu-18.04
* è¿è¡Œç¯å¢ƒä¾èµ– redis/mysql/mongodb/elasticsearch
* é€‰è£… kibana

#### ä¾èµ–å®‰è£…

é¦–å…ˆæ˜¯ celery è¿è¡Œéœ€è¦ä¾èµ– redis ä½œä¸º broker å’Œ backend

```shell script

*WSL2 Ubuntu Bash*

sudo apt update && apt upgrade
sudo apt install redis-server
```

ç„¶åæ˜¯ç”¨äºå­˜å‚¨ä»£ç†åœ°å€çš„ mysql

```shell script

*WSL2 Ubuntu Bash*

# clean the default mysql && mariadb
sudo apt remove --purge *mysql*
sudo rm -rf /etc/mysql /var/lib/mysql
sudo apt remove --purge *mariadb*
sudo apt autoremove
sudo apt autoclean

wget â€“c https://dev.mysql.com/get/mysql-apt-config_0.8.15-1_all.deb
sudo dpkg -i mysql-apt-config_0.8.15-1_all.deb # select 8.0

sudo apt update
sudo apt policy mysql-server #(it will show 8.0 is the default candidate)

sudo apt install mysql-server

```

ä¹‹åæ˜¯ç”¨äºå­˜å‚¨çˆ¬å–çš„æ–‡æœ¬å†…å®¹çš„ mongodb


```shell script

*WSL2 Ubuntu Bash*

wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | sudo apt-key add -

echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list

sudo apt update

sudo apt install -y mongodb-org

```

æœ€åæ˜¯ç”¨æ¥ä¿å­˜è¿è¡Œæ—¥å¿—ä½¿ç”¨çš„ elasticsearch && kibana (é€‰è£…)

```shell script

*WSL2 Ubuntu Bash*

wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -

sudo apt-get install apt-transport-https

echo "deb https://artifacts.elastic.co/packages/oss-7.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list 

sudo apt update

sudo apt install -y elasticsearch-oss kibana-oss

```

å®Œæˆä¸Šè¿°ä¾èµ–å®‰è£…ä¹‹åè¯·è‡ªè¡Œä¿®æ”¹å’Œè®°ä½ç›¸åº”é…ç½®ï¼Œä¿®æ”¹å…¶é…ç½®æ–‡ä»¶åˆ° 127.0.0.1:xxxx å¯¹åº”ç«¯å£ä¸Š

ç„¶ååˆ©ç”¨å¦‚ä¸‹å·¥å…·åœ¨ WSL2 ä¸‹å¯åŠ¨ systemctl åŠŸèƒ½è¿›è¡Œä¸Šè¿°è½¯ä»¶çš„å¼€å¯

[genie](https://github.com/arkane-systems/genie) A quick way into a systemd "bottle" for WSL

```shell script

*WSL2 Ubuntu Bash*

sudo apt install systemd-genie

echo -e "alias systemctl='genie -c systemctl'" > ~/.bash_aliase

```

å¦‚æœä¸Šè¿°æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œè¯·åœ¨issueæå‡º

#### å®‰è£…è¯´æ˜

ç„¶ååœ¨ Windows ä¸Šå®‰è£… [Visual Studio Community](https://visualstudio.microsoft.com/zh-hans/vs/community/) && [Python 3.7.6](https://www.python.org/downloads/)

è®°å¾— VS Community å‹¾é€‰ Build Tools && Python å‹¾é€‰ for all user

ç„¶åè¿›å…¥ä½  clone æœ¬ä»£ç çš„ç›®å½•

```shell script

*Windows Powershell*
# Run as Administrator

pip install -U pip

pip install virtualenv

virtualenv venv

.\venv\Scripts\activate

# å®‰è£…ç¯å¢ƒä¾èµ–
pip install -r requirements.txt

```

---

#### è¿è¡Œè¯´æ˜

å¯åŠ¨é¡¹ç›®

```shell script

*Windows Powershell*

celery -A deadpool worker -l info -P eventlet -E

```

![ä¸»ç¨‹åºå¯åŠ¨](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/main-start.jpg)

Beat worker

```shell script

*Windows Powershell*

celery -A deadpool beat

```

![å‘¨æœŸä»»åŠ¡å¯åŠ¨](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/beat-start.png)

è°ƒç”¨ä»»åŠ¡

```shell script

*Windows Powershell*

celery -A deadpool shell

# åœ¨å‡ºç°çš„Pythonç¼–è¾‘çª—å£ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤è°ƒç”¨ä»»åŠ¡
Python 3.7.6 (tags/v3.7.6:43364a7ae0, Dec 19 2019, 00:42:30) [MSC v.1916 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from celery.execute import send_task
>>> send_task('eastmoney')

```

![å¼‚æ­¥ä»»åŠ¡å¯åŠ¨](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/task-start.jpg)

ç›‘æ§ä»»åŠ¡

```shell script

celery -A deadpool flower

```

åŒæ—¶å¯ä»¥åœ¨ æµè§ˆå™¨ä¸­æ£€æµ‹ä»»åŠ¡è¿è¡ŒçŠ¶æ€
https://localhost:5555


---


#### ç»“æœæ ·ä¾‹

<p align="center">çˆ¬å–é¡µé¢å†…å®¹</p>

![çˆ¬å–ä»»åŠ¡](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/eg-crawler.jpg)

<p align="center">é¡µé¢å†…å®¹æå–</p>

![æå–ä»»åŠ¡](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/eg-middleware.jpg)

<p align="center">æå–ä¿¡æ¯å­˜å‚¨</p>

![å­˜å‚¨ä»»åŠ¡](https://raw.githubusercontent.com/Ryuchen/DeadPool/master/doc/img/eg-pipeline.jpg)

### ğŸ‘¤ ä½œè€…ä»‹ç»:

Ryuchen ( é™ˆ æµ© )

* Github: [https://github.com/Ryuchen](https://github.com/Ryuchen)
* Email: [chenhaom1993@hotmail.com](chenhaom1993@hotmail.com)
* QQ: 455480366
* å¾®ä¿¡: Chen_laws

Nameplace ( è™šä½ä»¥å¾… )

### ğŸ¤ è´¡çŒ®æºç :

Contributions, issues and feature requests are welcome!<br />Feel free to check [issues page](https://github.com/Ryuchen/DeadPool/tree/master/common/plugins).

### â­ æ¸´æœ›æ”¯æŒ: 

å¦‚æœä½ æƒ³ç»§ç»­è§‚å¯Ÿ Deadpool æ¥ä¸‹æ¥çš„èµ°å‘ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ è¿™æ˜¯å¯¹äºæˆ‘ä»¬æœ€å¤§çš„é¼“åŠ±ã€‚
æ­¤å¤–ï¼Œå¦‚æœä½ è§‰å¾— Deadpool å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä½ å¯ä»¥èµåŠ©æˆ‘ä»¬ä¸€æ¯å’–å•¡ï¼Œé¼“åŠ±æˆ‘ä»¬ç»§ç»­å¼€å‘ç»´æŠ¤ä¸‹å»ã€‚

| **å¾®ä¿¡**                         | **æ”¯ä»˜å®**                           |
| ------------------------------- | ----------------------------------- |
|<p align="center">![æ‰«ç èµåŠ©](https://raw.githubusercontent.com/Ryuchen/Panda-Sandbox/master/docs/sponsor/wechat.jpg)</p>|<p align="center">![æ‰«ç èµåŠ©](https://raw.githubusercontent.com/Ryuchen/Panda-Sandbox/master/docs/sponsor/alipay.jpg)</p>|

### ğŸ“ å¼€æºåè®®:

Copyright Â© 2019 [Ryuchen](https://github.com/Ryuchen).<br />
This project is [GPL](http://www.gnu.org/licenses/gpl-3.0.html) licensed.
è¯·è°¨éµå¼€æºåè®®ï¼Œè°¢è°¢ä½¿ç”¨ï¼

***
[![Release](https://img.shields.io/github/release/Ryuchen/DeadPool?color=blue)](https://github.com/Ryuchen/DeadPool/releases) [![Contributors](https://img.shields.io/github/contributors/Ryuchen/DeadPool?color=blue)](https://github.com/Ryuchen/DeadPool/graphs/contributors) [![Last commit](https://img.shields.io/github/last-commit/Ryuchen/DeadPool?color=blue)](https://github.com/Ryuchen/DeadPool/commits/master)
